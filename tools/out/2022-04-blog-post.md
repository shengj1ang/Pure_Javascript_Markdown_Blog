---
date: '2022-04-28T12:11:00.006+01:00'
description: ''
published: true
slug: 2022-04-blog-post
tags:
- http://schemas.google.com/blogger/2008/kind#post
- legacy-blogger
time_to_read: 5
title: "\u5185\u7F51\u7F51\u9875\u670D\u52A1\u5BF9\u5916\u7684\u6700\u4F73\u8F6C\u53D1\
  \u65B9\u6CD5"
---

*This was originally posted on blogger [here](https://sheng-jiang.blogspot.com/2022/04/blog-post.html)*.

<p>最后，我还是来把它写完吧。</p><p>下面是 对 内网网页服务对外的最佳转发方法 的经过</p><p>最后带有总结。</p><p><span style="color: #ffa400;">以下文字仅作记录，不是教程类。</span></p><p><span style="color: #ffa400;"><br /></span></p><p>- 这个问题其实并非我首先提出，大约半年前Liang开始在内网搭建docker类的服务，但是他是移动的，需要内网穿透。但是，在这么折腾过后，我发现不仅适合内网设备使用，凡是没有80 443端口的都非常适合。&nbsp; &nbsp; &nbsp;但是仅限Web 服务</p><p><br /></p><p>- 起初，我是有公网IP的，所以我的方法呢就是直接把它给转发到公网，但问题是配置SSL证书还是非常困难的，还要带端口号，你访问的时候又不能用80跳转到443。而且证书的获取很麻烦，国内的证书（freessl），有的软件不认。另外，个人觉得web服务带端口非常不美观。</p><p><br /></p><p>- SE Project 2021阶段，在这之前远控都是直接在服务器上放服务端的，这导致需要windows系统，而且我觉得不是太放心，在撤离阶段不是很好处理。所以2021的时候，我使用VPS的端口转发到我家的端口。我用起来还是很稳定的，就是屏幕记录功能的图片总是加载不出，我还以为是我之前逆向的问题。</p><p><br /></p><p>- 直到Liang给我推荐NPS，我刚开始也没想用，但是我装好了，之前的端口转发也废了，可能是iptable被它们互相改来改去的缘故，我重装了vps系统，只装NPS，最后发现图片加载不出的问题直接解决了。</p><p><br /></p><p>- Liang用NPS做了许多尝试，他还和我推荐了P2P的传输方法，我试过了，一是复杂，不能全系统兼容；二是安全性也没提升。三是稳定性没有保证。但是速度还是很快的。</p><p>Liang在此期间也搞定了网站，域名是离岸的，所以完全没想备案，所以国内机器肯定是用不了了。</p><p>江苏反诈非常疯狂，ip+port直接拦截了。</p><p>虽然我有曾把我家的机子开NPS给他用，但是我处于安全性问题，我最后还是卸载了，我不能保证他干的事情（这点在后面却是应验了，他在阿里云在转发社群软件，幸好没大规模传播）。</p><p>- 我在22年04月初 给他推荐的方案。可能有些许跳度。正好他也给我推荐了<span style="font-size: small;">Racknerd</span>的机子。</p><p><span style="font-size: x-small;">我稍阅读了下 nps和frp的文档。 原因是上周遗留了一个问题是：能否不通过Proxy直接连接server并且加密流量&amp;防止封禁。&nbsp; &nbsp;有一个很好的方法就是 client和server之间的连接也通过cloudflare。目前使用的是tcp bridge。但是nps的bridge type只有tcp和udp，这两个协议最好的办法也只能通过proxy。好在frp里是可以使用websocket作为bridge的，websocket已经被广泛运用于v2ray+ws+tls 加密性也能体现出来。 至于速度 可以参考 cloudflare优选IP，在vmess ws tls 速度还是可观的。 但是测试frp +ws的机会成本还是较大的，需要深入了解frp，但frp有web ui，看上去没nps的好。二是不知会不会影响现有的nps服务。三是速度和稳定性 可能比机场强点吧。所以或许是时候尝试FRP了。</span></p><p><span style="font-size: x-small;">有人做出了尝试：https://uknowsec.cn/posts/notes/FRP%E6%94%B9%E9%80%A0%E8%AE%A1%E5%88%92%E7%BB%AD.html</span><span style="font-size: small;">https://www.fenghong.tech/blog/ops/frpc-websocket/</span></p><p><span style="font-size: small;">我刚刚又想出一种简便的方法，也不需要frp，只需要拿现在那台服务器搭个vmess+ws+tls+cloudflare，然后你本地开代理，直接用优选的ip连接，然后v2ray server到nps的流量是机器内部流量。 所以根本不需要frp+ws了。</span><span style="font-size: small;">所以你那天win server上需装个v2ray的客户端，只需一个节点，clash用不上了。</span></p><p><span style="font-size: small;">Racknerd 1T双向流量，所以每月500G应该够了。</span></p><p>速度：</p><p><br /></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwMQHhFKTgKph3GLCvVdoOPx5o2KRI354lK5sbc3pNgHwVGQOF5FBN3EfgOMGoH3iARVjYXNkvWNBB6FwlqUs_iDUd_WDxD4JULg0ItgnHEJd3St903MNBpWNNPHaQ18HAAbSvIqm9DWjhppW6APUw0hCxTXGoVEEJ4lReYoYRDeJX_uYdlEFbY1cP/s2880/Screenshot%202022-04-28%20at%2010.13.49%20PM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjwMQHhFKTgKph3GLCvVdoOPx5o2KRI354lK5sbc3pNgHwVGQOF5FBN3EfgOMGoH3iARVjYXNkvWNBB6FwlqUs_iDUd_WDxD4JULg0ItgnHEJd3St903MNBpWNNPHaQ18HAAbSvIqm9DWjhppW6APUw0hCxTXGoVEEJ4lReYoYRDeJX_uYdlEFbY1cP/s320/Screenshot%202022-04-28%20at%2010.13.49%20PM.png" width="320" /></a></div><div class="separator" style="clear: both; text-align: center;">其实上传也不是太烂</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">稳定性：</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhuLGbtVFPbSwZcu0PM2l8hh7TB6FurQicSHkNhQBbVt8PmYybt2pJSRUD0LrqGSvROMSpSJYaGVPBfkQL5V3-ca9-kFmKZi-OGYruCSE8oDpEklAuTg14dgUPhCtb1ED-DsqbBdW93LQUUZAgTM3cZcPN0OygaPqS6i85vlL2Id2EJuNOWldvXTGWz/s2880/Screenshot%202022-04-28%20at%2010.32.41%20PM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhuLGbtVFPbSwZcu0PM2l8hh7TB6FurQicSHkNhQBbVt8PmYybt2pJSRUD0LrqGSvROMSpSJYaGVPBfkQL5V3-ca9-kFmKZi-OGYruCSE8oDpEklAuTg14dgUPhCtb1ED-DsqbBdW93LQUUZAgTM3cZcPN0OygaPqS6i85vlL2Id2EJuNOWldvXTGWz/s320/Screenshot%202022-04-28%20at%2010.32.41%20PM.png" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">垃圾破机场</div><div class="separator" style="clear: both; text-align: center;"><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhe9iE5Ze6KuWTMFGjqsIOPUKETrxgCXR5TnkgAaztFMrZ9P31mhhsMxzcfwIlIUJ0ST1ss0L8U0BFmQ5mO9HYN6VIbNt5pg01TQx1l_kH-XmfUtO4zGWz975b0UFTic_Q11OqhWLOAz616FcmBuH8PTD2sy6JS4oD8q26XQ47-c7epQbtXHJ5KLXv-/s2880/Screenshot%202022-04-28%20at%2010.33.42%20PM.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhe9iE5Ze6KuWTMFGjqsIOPUKETrxgCXR5TnkgAaztFMrZ9P31mhhsMxzcfwIlIUJ0ST1ss0L8U0BFmQ5mO9HYN6VIbNt5pg01TQx1l_kH-XmfUtO4zGWz975b0UFTic_Q11OqhWLOAz616FcmBuH8PTD2sy6JS4oD8q26XQ47-c7epQbtXHJ5KLXv-/s320/Screenshot%202022-04-28%20at%2010.33.42%20PM.png" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">稳定性反到比机场好</div><br /><br /></div>- 在这之后，我Blog里写了篇VLESS的文章，是针对上面速度慢的问题的。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">但是速度确实快了，Liang的Windows Server可解不过来了，CPU很容易满。这是其次，其实稳定性也非常差，动不动就会502错误。优选IP也没意义，因为那堆项目已经停了很久了。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">总结下：</div><div class="separator" style="clear: both; text-align: left;">1. 钱没花够肯定是不行的，这个多少得花点。</div><div class="separator" style="clear: both; text-align: left;">2. 我很早就觉得这没什么意义。服务提供给谁用呢。</div><div class="separator" style="clear: both; text-align: left;">3. 我看重的是稳定性，和在哪都能访问。Liang我感觉只看速度，而且非常不稳。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">全当是探索吧。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">来体现下我的分享精神。之前有读到文章，不记得在哪了。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">作者说，互联网分享上，大家缺少点精神。小白进入新项目往往是求着夸‘过来人’，过来人也可能只是刚刚学会而已，可能出于炫耀的目的教下小白。各种网站都有限制，不管是自发的还是被动的。。。</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">虽然文章写这完全没人看，但是也当我是分享了。搜索引擎不收录啊，国内也打不开。<br /><br /></div>写得乱七八糟的。<br /><p><br /></p><p><br /></p><p><br /></p><p><br /></p>